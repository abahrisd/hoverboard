function getSession(e,s,a,t,n){e.mainTag=e.tags?e.tags[0]:"General",e.day=a+1,s.tags.indexOf(e.mainTag)<0&&s.tags.push(e.mainTag),t.tags.indexOf(e.mainTag)<0&&t.tags.push(e.mainTag);var r=[];if(e.speakers)for(var i=0,g=e.speakers.length;i<g;i++)if(!e.speakers[i].id){e.speakers[i]=n[e.speakers[i]];var o=JSON.parse(JSON.stringify(e));delete o.speakers,e.speakers[i]&&(e.speakers[i].sessions||(e.speakers[i].sessions=[]),e.speakers[i].sessions.push(o),r.push(e.speakers[i].name))}return e}function getEndTime(e,s,a,t,n){var r=(new Date).toString().match(/([A-Z]+[\+-][0-9]+.*)/)[1],i=new Date(e+" "+s+" "+r).getTime(),g=new Date(e+" "+a+" "+r).getTime(),o=Math.floor((g-i)/t),d=new Date(i+o*n);return d.getHours()+":"+d.getMinutes()}self.addEventListener("message",function(e){var s=e.data.speakers,a=e.data.sessions,t=e.data.schedule;t.tags=[];for(var n=0,r=t.length;n<r;n++){var i=t[n];t[n].tags=[];for(var g=0,o=i.timeslots.length;g<o;g++)for(var d=i.timeslots[g],m=0,p=d.sessions.length;m<p;m++)for(var l=0,f=d.sessions[m].length;l<f;l++){var k=getSession(a[d.sessions[m][l]],i,n,t,s);k&&!k.track&&(k.track=i.tracks[m]),k.startTime=d.startTime,k.endTime=f>1?getEndTime(i.date,d.startTime,d.endTime,f,l+1):d.endTime,k.dateReadable=i.dateReadable,t[n].timeslots[g].sessions[m][l]=k}}self.postMessage({speakers:s,sessions:a,schedule:t})},!1);